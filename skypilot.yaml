# To launch, run the following command from the root directory of the art repository:
# `uv run sky launch skypilot.yaml --env-file=.env --yes --retry-until-up --down --idle-minutes-to-autostop 60 --fast --cluster=kyle-email-agent-002 --env RUN_ID=002`

workdir: .
resources:
  accelerators: ["H100-SXM:1"]
envs:
  HF_HUB_ENABLE_HF_TRANSFER: 1
  WANDB_API_KEY:
  OPENPIPE_API_KEY:
  RUN_ID:
  AWS_ACCESS_KEY_ID:
  AWS_SECRET_ACCESS_KEY:
  AWS_REGION:
  BACKUP_BUCKET:

file_mounts:
  ~/ART: ../ART

setup: |
  curl -LsSf https://astral.sh/uv/install.sh | sh

  source $HOME/.local/bin/env

  uv remove openpipe-art
  uv add ~/ART
  uv add awscli
  uv sync

run: |
  echo "Running training script..."
  uv run python email_deep_research/train.py
